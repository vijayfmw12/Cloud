<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Residents List</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .active-page {
            font-weight: bold;
            text-decoration: underline;
        }
        .pagination-links {
            list-style: none;
            display: flex;
            gap: 5px;
            padding-left: 0;
            margin-top: 10px;
        }
        .pagination-links a {
            text-decoration: none;
        }
    </style>
</head>
<body>

    <!-- âœ… Include NAVBAR fragment -->
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container" style="padding: 20px;">
        <h1>Residents of Tripura Homes</h1>

        <!-- ðŸ” Search Form -->
        <form th:action="@{/residents}" method="get" style="margin-bottom: 10px;">
            <input type="text" name="keyword" placeholder="Search by name, flat no, or contact"
                   th:value="${keyword}" />
            <button type="submit">Search</button>
            <a th:href="@{/residents}">Reset</a>
            <input type="hidden" name="size" th:value="${size}" />
        </form>

        <!-- ðŸ”¢ Page Size Selector -->
        <form method="get" th:action="@{/residents}" style="margin-bottom: 10px;">
            <label>Entries per page:
                <select name="size" onchange="this.form.submit()">
                    <option th:value="5" th:selected="${size == 5}">5</option>
                    <option th:value="10" th:selected="${size == 10}">10</option>
                    <option th:value="20" th:selected="${size == 20}">20</option>
                </select>
            </label>
            <input type="hidden" name="keyword" th:value="${keyword}">
        </form>

        <!-- ðŸ“‹ Residents Table -->
        <table border="1">
            <thead>
                <tr>
                    <th>S.No</th>
                    <th>Owner Name</th>
                    <th>Flat No</th>
                    <th>Contact No</th>
                    <th>Email</th>
                    <th>Road No</th>
                    <th>Facing</th>
                    <th>Status</th>
                    <th>Remarks</th>
                    <th>Created On</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="resident, iterStat : ${residentsPage.content}">
                    <td th:text="${iterStat.index + 1 + (residentsPage.number * residentsPage.size)}">1</td>
                    <td th:text="${resident.ownerName}">John Doe</td>
                    <td th:text="${resident.flatNo}">101</td>
                    <td th:text="${resident.contactNo}">1234567890</td>
                    <td th:text="${resident.email}">john@example.com</td>
                    <td th:text="${resident.roadNo}">5</td>
                    <td th:text="${resident.facing}">East</td>
                    <td th:text="${resident.status}">Active</td>
                    <td th:text="${resident.remarks}">None</td>
                    <td th:text="${#temporals.format(resident.createdOn, 'yyyy-MM-dd HH:mm')}">2025-06-05</td>
                </tr>
            </tbody>
        </table>

        <!-- ðŸ“„ Pagination Controls -->
        <div th:if="${totalPages > 1}">
            <ul class="pagination-links">
                <li th:if="${currentPage > 0}">
                    <a th:href="@{/residents(page=${currentPage - 1}, size=${size}, keyword=${keyword})}">&laquo; Prev</a>
                </li>
                <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                    <a th:href="@{/residents(page=${i}, size=${size}, keyword=${keyword})}"
                       th:text="${i + 1}"
                       th:classappend="${i == currentPage} ? 'active-page' : ''"></a>
                </li>
                <li th:if="${currentPage < totalPages - 1}">
                    <a th:href="@{/residents(page=${currentPage + 1}, size=${size}, keyword=${keyword})}">Next &raquo;</a>
                </li>
            </ul>
        </div>

        <br/>
        <a th:href="@{/}">Back to Home</a>
    </div>

    <!-- âœ… Include FOOTER fragment -->
    <div th:replace="~{fragments/footer :: footer}"></div>

</body>
</html>
